<!-- src/app/components/cliente/dashboard-cliente/dashboard-cliente.html -->
<div class="dashboard-cliente">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>Â¡Bienvenido, {{ user?.nombre }}! ğŸ‘‹</h1>
      <p>Este es tu panel de control personal</p>
    </div>
    <div class="header-stats">
      <div class="header-stat">
  <span class="stat-icon">ğŸ“…</span>
  <span>{{ fechaActual }}</span>
</div>

    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Cargando tu dashboard...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <div class="error-message">
      <h3>âš ï¸ Error</h3>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="loadDashboard()">
        Reintentar
      </button>
    </div>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="!loading && !error && dashboard" class="dashboard-content">
    
    <!-- Notificaciones Importantes -->
    <div *ngIf="dashboard.notificacionesImportantes?.length" class="notifications-section">
      <h2>ğŸ”” Notificaciones Importantes</h2>
      <div class="notifications-list">
        <div 
          *ngFor="let notification of dashboard.notificacionesImportantes.slice(0, 3)" 
          class="notification-item"
          [ngClass]="getPriorityClass(notification.prioridad)"
        >
          <span class="notification-icon">{{ notification.icono }}</span>
          <div class="notification-content">
            <h4>{{ notification.titulo }}</h4>
            <p>{{ notification.mensaje }}</p>
            <small>{{ formatDate(notification.fecha) }}</small>
          </div>
        </div>
      </div>
    </div>

    <!-- EstadÃ­sticas Principales -->
    <div class="stats-grid">
      <!-- Resumen de Compras -->
      <div class="stat-card primary">
        <div class="stat-header">
          <h3>ğŸ’° Resumen de Compras</h3>
          <span class="stat-icon">ğŸ›’</span>
        </div>
        <div class="stat-content">
          <div class="main-stat">
            <span class="stat-number">{{ dashboard.resumenCompras.totalCompras }}</span>
            <span class="stat-label">Compras Realizadas</span>
          </div>
          <div class="sub-stats">
            <div class="sub-stat">
              <span class="sub-stat-number">{{ formatCurrency(dashboard.resumenCompras.totalGastado) }}</span>
              <span class="sub-stat-label">Total Gastado</span>
            </div>
            <div class="sub-stat">
              <span class="sub-stat-number">{{ formatCurrency(dashboard.resumenCompras.promedioGasto) }}</span>
              <span class="sub-stat-label">Promedio por Compra</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Productos Adquiridos -->
      <div class="stat-card success">
        <div class="stat-header">
          <h3>ğŸ“¦ Mis Productos</h3>
          <span class="stat-icon">ğŸ“‹</span>
        </div>
        <div class="stat-content">
          <div class="main-stat">
            <span class="stat-number">{{ dashboard.productosAdquiridos.totalProductosUnicos }}</span>
            <span class="stat-label">Productos Ãšnicos</span>
          </div>
          <div class="sub-stats">
            <div class="sub-stat">
              <span class="sub-stat-number">{{ dashboard.productosAdquiridos.productosConGarantiaVigente }}</span>
              <span class="sub-stat-label">Con GarantÃ­a Vigente</span>
            </div>
            <div class="sub-stat favorite-product">
              <span class="sub-stat-label">MÃ¡s Comprado:</span>
              <span class="sub-stat-text">{{ dashboard.productosAdquiridos.productoMasComprado }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Estado de Comentarios -->
      <div class="stat-card info">
        <div class="stat-header">
          <h3>â­ Mis Comentarios</h3>
          <span class="stat-icon">ğŸ’¬</span>
        </div>
        <div class="stat-content">
          <div class="main-stat">
            <span class="stat-number">{{ dashboard.estadoComentarios.totalComentarios }}</span>
            <span class="stat-label">Comentarios Totales</span>
          </div>
          <div class="sub-stats">
            <div class="sub-stat">
              <span class="sub-stat-number">{{ dashboard.estadoComentarios.comentariosAprobados }}</span>
              <span class="sub-stat-label">Aprobados</span>
            </div>
            <div class="sub-stat">
              <span class="sub-stat-number">{{ dashboard.estadoComentarios.comentariosPendientes }}</span>
              <span class="sub-stat-label">Pendientes</span>
            </div>
            <div class="sub-stat">
              <span class="sub-stat-number">{{ dashboard.estadoComentarios.calificacionPromedio }}/5</span>
              <span class="sub-stat-label">CalificaciÃ³n Promedio</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Actividad Este Mes -->
      <div class="stat-card warning">
        <div class="stat-header">
          <h3>ğŸ“Š Este Mes</h3>
          <span class="stat-icon">ğŸ“…</span>
        </div>
        <div class="stat-content">
          <div class="main-stat">
            <span class="stat-number">{{ dashboard.resumenCompras.comprasEsteMes }}</span>
            <span class="stat-label">Compras Este Mes</span>
          </div>
          <div class="sub-stats">
            <div class="sub-stat">
              <span class="sub-stat-number">{{ formatCurrency(dashboard.resumenCompras.gastoEsteMes) }}</span>
              <span class="sub-stat-label">Gastado Este Mes</span>
            </div>
            <div class="sub-stat">
              <span class="sub-stat-number">{{ dashboard.resumenCompras.ventasPendientes }}</span>
              <span class="sub-stat-label">Pedidos Pendientes</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- SecciÃ³n Principal -->
    <div class="main-sections">
      
      <!-- Actividad Reciente -->
      <div class="recent-activity">
        <h2>ğŸ“‹ Actividad Reciente</h2>
        <div *ngIf="dashboard.actividadReciente?.length; else noActivity" class="activity-list">
          <div 
            *ngFor="let activity of dashboard.actividadReciente" 
            class="activity-item"
          >
            <span class="activity-icon">{{ getActivityIcon(activity.tipo) }}</span>
            <div class="activity-content">
              <h4>{{ activity.descripcion }}</h4>
              <div class="activity-meta">
                <span class="activity-date">{{ formatDate(activity.fecha) }}</span>
                <span class="activity-status" [ngClass]="'status-' + activity.estado.toLowerCase()">
                  {{ activity.estado }}
                </span>
              </div>
            </div>
          </div>
        </div>
        <ng-template #noActivity>
          <div class="no-activity">
            <p>No hay actividad reciente</p>
          </div>
        </ng-template>
      </div>

      <!-- Accesos RÃ¡pidos -->
      <div class="quick-access">
        <h2>ğŸš€ Accesos RÃ¡pidos</h2>
        <div class="quick-access-grid">
          <a 
            *ngFor="let access of dashboard.accesosRapidos" 
            [routerLink]="access.url"
            class="quick-access-item"
            [style.border-left-color]="access.color"
          >
            <span class="access-icon">{{ access.icono }}</span>
            <div class="access-content">
              <h4>{{ access.titulo }}</h4>
              <p>{{ access.descripcion }}</p>
            </div>
            <span class="access-arrow">â†’</span>
          </a>
        </div>
      </div>
    </div>

    <!-- EstadÃ­sticas Generales -->
    <div class="general-stats">
      <h2>ğŸ“ˆ EstadÃ­sticas Generales</h2>
      <div class="general-stats-grid">
        <div class="general-stat-item">
          <div class="general-stat-icon">ğŸ‘¤</div>
          <div class="general-stat-content">
            <h4>{{ dashboard.estadisticasGenerales.diasComoCliente }} dÃ­as</h4>
            <p>Como cliente SmartAgro</p>
            <small>Desde {{ formatDate(dashboard.estadisticasGenerales.fechaRegistro) }}</small>
          </div>
        </div>

        <div *ngIf="dashboard.estadisticasGenerales.productosFavoritos?.length" class="general-stat-item">
          <div class="general-stat-icon">â¤ï¸</div>
          <div class="general-stat-content">
            <h4>Productos Favoritos</h4>
            <div class="favorite-products">
              <span 
                *ngFor="let producto of dashboard.estadisticasGenerales.productosFavoritos.slice(0, 3)" 
                class="favorite-tag"
              >
                {{ producto }}
              </span>
            </div>
          </div>
        </div>

        <div class="general-stat-item">
          <div class="general-stat-icon">ğŸ¯</div>
          <div class="general-stat-content">
            <h4>Estado de Cuenta</h4>
            <p>{{ dashboard.resumenCompras.ventasEntregadas }} entregas completadas</p>
            <small>{{ dashboard.resumenCompras.ventasPendientes }} pedidos en proceso</small>
          </div>
        </div>
      </div>
    </div>

    <!-- PrÃ³ximas Acciones Sugeridas -->
    <div *ngIf="dashboard.notificacionesImportantes?.length" class="suggested-actions">
      <h2>ğŸ’¡ Acciones Sugeridas</h2>
      <div class="actions-list">
        <div class="action-item" *ngIf="dashboard.estadoComentarios.comentariosPendientes === 0">
          <span class="action-icon">â­</span>
          <div class="action-content">
            <h4>Comparte tu experiencia</h4>
            <p>Â¿Has probado alguno de tus productos? Â¡Danos tu opiniÃ³n!</p>
          </div>
          <a routerLink="/cliente/comentarios" class="action-button">
            Comentar
          </a>
        </div>

        <div class="action-item">
          <span class="action-icon">ğŸ“š</span>
          <div class="action-content">
            <h4>Explora los recursos</h4>
            <p>Descarga manuales y accede a documentaciÃ³n tÃ©cnica</p>
          </div>
          <a routerLink="/cliente/documentacion" class="action-button">
            Ver Recursos
          </a>
        </div>

        <div class="action-item" *ngIf="dashboard.productosAdquiridos.productosConGarantiaVigente > 0">
          <span class="action-icon">ğŸ›¡ï¸</span>
          <div class="action-content">
            <h4>Revisa tus garantÃ­as</h4>
            <p>Tienes {{ dashboard.productosAdquiridos.productosConGarantiaVigente }} productos con garantÃ­a vigente</p>
          </div>
          <a routerLink="/cliente/documentacion" class="action-button">
            Ver GarantÃ­as
          </a>
        </div>
      </div>
    </div>

  </div>
</div>